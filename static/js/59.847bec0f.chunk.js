(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[59],{727:function(e,t,a){},794:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(45),i=a(13),o=a(8),s=a(33),c=a.n(s),l=a(555),u=a(332),d=a(558),m=a(207),b=a(560),j=a(561),p=a(551),g=a(559),h=a(636),x=a(333),O=a(633),f=a(660),v=a(50),_=a(205),w=a(2),y=a(25),E=a(112),C=(a(94),a(51)),N=a.n(C),T=a(212),R=a(643),V=a(653),S=(a(655),a(727),a(659),a(1)),D=Object(v.a)(_.a)((function(){return{display:"flex",alignItems:"center"}})),I=Object(v.a)("div")((function(e){var t,a=e.theme;return t={margin:"30px"},Object(o.a)(t,a.breakpoints.down("sm"),{margin:"16px"}),Object(o.a)(t,"& .breadcrumb",Object(o.a)({marginBottom:"30px"},a.breakpoints.down("sm"),{marginBottom:"16px"})),t})),k=Object(v.a)(l.a)((function(){return{width:"120px !important",height:"120px !important",border:"2px"}})),A=Object(v.a)(E.TextValidator)((function(){return{width:"100%",marginBottom:"16px"}})),F=(Object(v.a)(E.SelectValidator)((function(){return{width:"100%",marginBottom:"16px",marginTop:"8px"}})),Object(v.a)(u.a)((function(){return{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:120,height:120,borderRadius:"50%",borderColor:"#3498db"}}))),L=Object(v.a)(d.a)((function(){return{position:"absolute",top:"6px",left:"25px"}})),P=Object(v.a)(u.a)((function(){return{display:"block",color:"#fff",marginTop:"20px",width:"86px",backgroundColor:"#e15260","&:hover":{backgroundColor:"#cc2333",color:"#fff"}}}));t.default=function(e){var t=Object(y.f)(),a=Object(w.useState)({firstName:"",lastName:"",email:"",area_code:"",phone_number:"",traumas:[],logo:null,logo_image:""}),s=Object(i.a)(a,2),l=s[0],d=s[1],v=Object(w.useState)([]),C=Object(i.a)(v,2),U=C[0],M=C[1],B=Object(w.useState)(!1),H=Object(i.a)(B,2),q=H[0],X=H[1],Q=Object(w.useState)(null),W=Object(i.a)(Q,2),G=W[0],z=W[1],Y=Object(w.useState)(""),J=Object(i.a)(Y,2),K=J[0],Z=J[1],$=Object(w.useState)(!1),ee=Object(i.a)($,2),te=ee[0],ae=ee[1],re=Object(w.useState)(!1),ne=Object(i.a)(re,2),ie=ne[0],oe=ne[1],se=Object(w.useState)({status:"success",message:""}),ce=Object(i.a)(se,2),le=ce[0],ue=ce[1],de=Object(w.useState)(!1),me=Object(i.a)(de,2),be=me[0],je=me[1],pe=Object(w.useState)(""),ge=Object(i.a)(pe,2),he=ge[0],xe=ge[1],Oe=Object(w.useRef)();function fe(e){e.persist(),d(Object(r.a)(Object(r.a)({},l),{},Object(o.a)({},e.target.name,e.target.value)))}Object(w.useEffect)((function(){return E.ValidatorForm.addValidationRule("REQUIRED",(function(e){return 0!==e.length})),E.ValidatorForm.addValidationRule("MAX_CODE_LENGTH",(function(e){return!e||3===e.length})),E.ValidatorForm.addValidationRule("VALID_INPUT",(function(e){return!e||!isNaN(e)})),E.ValidatorForm.addValidationRule("MAX_PHONE_LENGTH",(function(e){return!e||7===e.length})),E.ValidatorForm.addValidationRule("MAX_POSTAL_CODE",(function(e){return!e||5===e.length})),Object(n.a)(c.a.mark((function e(){var t,a,r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(T.w)();case 3:return"UnauthorizedError"===(null===(a=e.sent)||void 0===a||null===(t=a.error)||void 0===t?void 0:t.name)?(je(!0),xe("Your session has expired. You will be logged out.")):a&&a.data&&M(a.data),e.next=7,Object(T.o)();case 7:r=e.sent,n=r.roles,console.log("ROLES",n),n&&n.length>0&&n.map((function(e){"provider"!==e.type&&"counsellor"!==e.type||z(e)})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))(),function(){E.ValidatorForm.removeValidationRule("REQUIRED"),E.ValidatorForm.removeValidationRule("MAX_CODE_LENGTH"),E.ValidatorForm.removeValidationRule("VALID_INPUT"),E.ValidatorForm.removeValidationRule("MAX_PHONE_LENGTH"),E.ValidatorForm.removeValidationRule("MAX_POSTAL_CODE")}}),[]);var ve=function(e){return new Promise((function(t){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t(e.target.result)},a.onerror=function(e){console.log("Error: ",e)}}))},_e=function(){var e=Object(n.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files[0],!["image/jpeg","image/jpg","image/png","image/svg","image/svg+xml"].includes(a.type)){e.next=9;break}return e.next=5,ve(a);case 5:a.base64=e.sent,d(Object(r.a)(Object(r.a)({},l),{},{logo:a})),e.next=10;break;case 9:V.b.error("Only files with following extensions are allowed: jpeg, jpg, png, svg",{theme:"colored"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(n.a)(c.a.mark((function e(t){var a,r,n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("files",t),r="",localStorage.accessToken&&(r=localStorage.accessToken),e.next=6,fetch("http://localhost:1337/api/upload",{method:"post",headers:{authorization:"Bearer "+r},body:a});case 6:return n=e.sent,e.next=9,n.text();case 9:return i=e.sent,e.abrupt("return",JSON.parse(i));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(n.a)(c.a.mark((function e(t){var a,n,i,o,s,u,d,m,b,j;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.firstName,n=l.lastName,i=l.email,o=l.area_code,s=l.phone_number,u=l.traumas,d=l.logo,0!==u.length){e.next=3;break}return e.abrupt("return");case 3:if(X(!0),!d){e.next=8;break}return e.next=7,we(d);case 7:m=e.sent;case 8:b=u.map((function(e){return U.find((function(t){if(t&&t.attributes&&t.attributes.trauma_code===e)return t.id}))})),j={counsellor:{data:{name:a+" "+n,first_name:a,last_name:n,email:i,area_code:o,phone_number:s,status:"Approved",traumas:b,publishedAt:N()().format().split("T")[0]+" "+N()().format().split("T")[1].slice(0,8)}},traumas:b,user:{data:{email:i,confirmed:!0,blocked:!1,role:G.id}}},d&&(j.counsellor.data.logo_image=m[0].url||""),Object(T.c)(j).then((function(e){var t;X(!1),"UnauthorizedError"===(null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.name)?(je(!0),xe("Your session has expired. You will be logged out.")):(oe(!0),ue(Object(r.a)(Object(r.a)({},le),{},{status:e&&"success"===e.status?"success":"error",message:e&&e.message||""})))})).catch((function(e){X(!1),oe(!0),ue(Object(r.a)(Object(r.a)({},le),{},{status:"error",message:"Something went wrong"}))}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){te||ae(!0);var e="";0===l.traumas.length&&(e="This field is required!"),Z(e)},Ce=l.firstName,Ne=l.lastName,Te=l.email,Re=l.area_code,Ve=l.phone_number,Se=l.traumas,De=l.logo;return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(I,{children:[Object(S.jsx)("h1",{style:{marginTop:"0px",marginBottom:"10px",padding:"0px"},children:"Add Provider"}),Object(S.jsxs)("div",{className:"center-card",children:[Object(S.jsxs)(E.ValidatorForm,{ref:Oe,onSubmit:ye,onError:function(){return null},children:[Object(S.jsxs)(m.a,{container:!0,rowSpacing:2,columnSpacing:6,children:[Object(S.jsx)(m.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(S.jsx)(A,{autoFocus:!0,margin:"dense",id:"first_name",name:"firstName",label:"First Name*",type:"text",value:Ce,onChange:fe,fullWidth:!0,validators:["REQUIRED"],errorMessages:["This field is required"]})}),Object(S.jsx)(m.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(S.jsx)(A,{margin:"dense",id:"last_name",name:"lastName",label:"Last Name*",type:"text",value:Ne,onChange:fe,fullWidth:!0,validators:["REQUIRED"],errorMessages:["This field is required"]})})]}),Object(S.jsxs)(m.a,{container:!0,rowSpacing:2,columnSpacing:6,children:[Object(S.jsx)(m.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(S.jsx)(A,{margin:"dense",id:"email",name:"email",label:"Email*",type:"email",value:Te,onChange:fe,fullWidth:!0,validators:["REQUIRED","isEmail"],errorMessages:["This field is required","email is not valid"]})}),Object(S.jsx)(m.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(S.jsxs)(m.a,{container:!0,children:[Object(S.jsx)(m.a,{item:!0,xs:3,sm:3,md:3,lg:3,children:Object(S.jsx)(A,{margin:"dense",id:"area_code",name:"area_code",label:"Area Code*",type:"text",value:Re,onChange:fe,fullWidth:!0,validators:["REQUIRED","VALID_INPUT","MAX_CODE_LENGTH"],errorMessages:["This field is required","Invalid area code","Area code should have 3 digits"]})}),Object(S.jsx)(m.a,{item:!0,xs:1,sm:1,md:1,lg:1,children:Object(S.jsx)("div",{className:"phone_line",children:"\xa0"})}),Object(S.jsx)(m.a,{item:!0,xs:8,sm:8,md:8,lg:8,children:Object(S.jsx)(A,{margin:"dense",id:"phone_number",name:"phone_number",label:"Phone Number*",type:"text",value:Ve,onChange:fe,fullWidth:!0,validators:["REQUIRED","VALID_INPUT","MAX_PHONE_LENGTH"],errorMessages:["This field is required","Invalid phone number","Phone number must be of 7 digits"]})})]})})]}),Object(S.jsx)(m.a,{container:!0,rowSpacing:2,columnSpacing:6,children:Object(S.jsx)(m.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(S.jsxs)(b.a,{sx:{mt:2,width:250},error:!Se.length&&!!te,children:[Object(S.jsx)(j.a,{id:0===Se.length&&te?"demo-simple-select-error-label":"open-select-label",children:"Trauma Type*"}),Object(S.jsxs)(p.a,{labelId:"open-select-label",margin:"dense",id:"center_type",name:"traumas",multiple:!0,value:Se,input:Object(S.jsx)(g.a,{label:"Trauma Type"}),style:{borderColor:"#FF3D57"},onChange:function(e){var t=e.target.value;Z(0===t.length?"This field is required!":""),d(Object(r.a)(Object(r.a)({},l),{},{traumas:t})),ae(!0)},onBlur:function(){return Ee()},fullWidth:!0,validators:["required"],children:[Object(S.jsx)(h.a,{disabled:!0,value:"",children:Object(S.jsx)("em",{children:"Trauma Type"})}),U&&U.map((function(e,t){return Object(S.jsx)(h.a,{value:e.attributes.trauma_code,children:e.attributes.trauma_name},t)}))]}),K&&Object(S.jsx)("p",{className:"form-err",children:K})]})})}),Object(S.jsx)(m.a,{container:!0,spacing:6,children:Object(S.jsxs)(m.a,{item:!0,lg:12,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[De?Object(S.jsx)(k,{src:De.base64}):Object(S.jsxs)(F,{variant:"contained",component:"label",children:[Object(S.jsx)(x.a,{children:"file_upload_outlined"}),"Upload Logo",Object(S.jsx)("input",{type:"file",hidden:!0,accept:"image/*",multiple:!0,onChange:_e})]}),Object(S.jsx)(m.a,{item:!0,style:{flexDirection:"column"},children:Object(S.jsx)(u.a,{variant:"contained",component:"label",color:"inherit",sx:{marginLeft:"15px",marginTop:"15px",height:"35px",marginBottom:"16px"},onClick:function(){return d(Object(r.a)(Object(r.a)({},l),{},{logo:null,logo_image:""}))},children:"Reset Logo"})})]})}),Object(S.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:Object(S.jsxs)(D,{flexWrap:"wrap",children:[Object(S.jsxs)(_.a,{mr:2,position:"relative",children:[Object(S.jsx)(u.a,{variant:"contained",color:"primary",disabled:q,type:"submit",onClick:function(){return Ee()},children:"Submit"}),q&&Object(S.jsx)(L,{size:24,className:"buttonProgress"})]}),Object(S.jsx)(P,{sx:{marginBottom:2},onClick:function(){return Oe.current.resetValidations(),d(Object(r.a)(Object(r.a)({},l),{},{firstName:"",lastName:"",email:"",area_code:Re,phone_number:"",traumas:[],logo:null,logo_image:""})),void t(-1)},children:"Cancel"})]})})]}),Object(S.jsx)(O.a,{open:ie,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,onClose:function(){oe(!1),t("/counsellors")},children:Object(S.jsx)(f.a,{onClose:function(){oe(!1),t("/counsellors")},variant:"filled",severity:le.status,sx:{width:"100%"},children:le.message})}),Object(S.jsx)(R.a,{open:be,text:he,onConfirmDialogClose:function(){xe(""),je(!1)},onYesClick:function(){xe(""),je(!1)}})]})]})})}},895:function(e,t,a){"use strict";a.r(t);var r=a(13),n=a(2),i=a(882),o=a(702),s=a(918),c=a(793),l=a(794),u=a(1);t.default=function(){var e=Object(n.useState)("Center"),t=Object(r.a)(e,2),a=t[0],d=t[1],m=Object(n.useRef)();Object(n.useEffect)((function(){m.current.scrollIntoView()}),[]);return Object(u.jsx)("div",{className:"user-container",ref:m,children:Object(u.jsxs)("div",{style:{margin:"15px",padding:"0px"},children:[Object(u.jsx)("h1",{style:{margin:"0px",marginBottom:"15px"},children:"Add User"}),Object(u.jsxs)(i.a,{sx:{mb:2},value:a,name:"userRole",onChange:function(e){var t=e.target.value;d(t),m.current.scrollIntoView()},row:!0,children:[Object(u.jsx)(o.a,{value:"Center",control:Object(u.jsx)(s.a,{color:"secondary"}),label:"Add Center",labelPlacement:"end"}),Object(u.jsx)(o.a,{value:"Counsellor",control:Object(u.jsx)(s.a,{color:"secondary"}),label:"Add Provider",labelPlacement:"end"})]}),"Center"===a&&Object(u.jsx)(c.a,{}),"Counsellor"===a&&Object(u.jsx)(l.default,{breadcrumb:!1})]})})}}}]);
//# sourceMappingURL=59.847bec0f.chunk.js.map