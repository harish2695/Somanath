(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[56],{643:function(e,t,a){"use strict";a(2);var n=a(332),r=a(50),i=a(331),o=a(334),c=a(205),l=a(25),s=a(1),d={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #fff",boxShadow:24,p:4};Object(r.a)(n.a)((function(){return{display:"block",color:"#fff",marginTop:"20px",width:"86px",backgroundColor:"#e15260","&:hover":{backgroundColor:"#cc2333",color:"#fff"}}}));t.a=function(e){var t=e.open,a=e.onConfirmDialogClose,r=e.text,u=(e.onYesClick,Object(l.f)()),m=function(){a(),localStorage.removeItem("accessToken"),u("/session/signin")};return Object(s.jsx)("div",{children:Object(s.jsx)(i.a,{keepMounted:!0,open:t,onClose:function(){return m()},"aria-labelledby":"keep-mounted-modal-title","aria-describedby":"keep-mounted-modal-description",children:Object(s.jsxs)(c.a,{sx:d,children:[Object(s.jsx)(o.a,{id:"keep-mounted-modal-title",variant:"h6",component:"h2",sx:{color:"#333"},children:r}),Object(s.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"1rem"},children:Object(s.jsx)(c.a,{position:"relative",sx:{display:"block",marginTop:"20px"},children:Object(s.jsx)(n.a,{color:"primary",variant:"contained",onClick:function(){return m()},children:"Ok"})})})]})})})}},729:function(e,t,a){},905:function(e,t,a){"use strict";a.r(t);var n=a(8),r=a(6),i=a(45),o=a(13),c=a(33),l=a.n(c),s=a(555),d=a(332),u=a(207),m=a(560),b=a(561),j=a(551),p=a(559),h=a(636),f=a(333),x=a(633),g=a(660),O=a(50),v=a(205),_=a(2),y=a(25),w=a(112),C=a(51),N=a.n(C),T=a(212),k=(a(655),a(801)),S=a(95),V=(a(729),a(94)),E=a(215),A=a(35),D=a(643),I=a(1),L=Object(O.a)(v.a)((function(){return{display:"flex",alignItems:"center"}})),P=Object(O.a)(s.a)((function(){return{width:"120px !important",height:"120px !important",border:"2px"}})),F=Object(O.a)(w.TextValidator)((function(){return{width:"100%",marginBottom:"16px"}})),M=Object(O.a)(d.a)((function(){return{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:120,height:120,borderRadius:"50%",borderColor:"#3498db"}}));t.default=function(){var e=Object(y.f)(),t=Object(S.a)().user,a=Object(_.useState)({firstName:"",lastName:"",email:"",area_code:"",phone_number:"",traumas:[],logo:null,logo_image:""}),c=Object(o.a)(a,2),s=c[0],O=c[1],C=Object(_.useState)(!1),R=Object(o.a)(C,2),q=R[0],H=R[1],U=Object(_.useState)(!1),W=Object(o.a)(U,2),X=W[0],z=W[1],G=Object(_.useState)(""),Y=Object(o.a)(G,2),B=Y[0],J=Y[1],K=Object(_.useState)([]),Q=Object(o.a)(K,2),Z=Q[0],$=Q[1],ee=Object(_.useState)(!1),te=Object(o.a)(ee,2),ae=te[0],ne=te[1],re=Object(_.useState)(null),ie=Object(o.a)(re,2),oe=ie[0],ce=ie[1],le=Object(_.useState)(!1),se=Object(o.a)(le,2),de=se[0],ue=se[1],me=Object(_.useState)(""),be=Object(o.a)(me,2),je=be[0],pe=be[1],he=Object(_.useRef)(),fe=Object(E.b)();function xe(e){e.persist(),O(Object(r.a)(Object(r.a)({},s),{},Object(n.a)({},e.target.name,e.target.value)))}Object(_.useEffect)((function(){return fe(Object(A.l)()),w.ValidatorForm.addValidationRule("MAX_CODE_LENGTH",(function(e){return!e||3===e.length})),w.ValidatorForm.addValidationRule("VALID_INPUT",(function(e){return!e||!isNaN(e)})),w.ValidatorForm.addValidationRule("MAX_PHONE_LENGTH",(function(e){return!e||7===e.length})),w.ValidatorForm.addValidationRule("MAX_POSTAL_CODE",(function(e){return!e||5===e.length})),Object(i.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(T.w)();case 3:return"UnauthorizedError"===(null===(a=e.sent)||void 0===a||null===(t=a.error)||void 0===t?void 0:t.name)&&(ue(!0),pe("Your session has expired. You will be logged out.")),a&&a.data&&$(a.data),e.next=8,Object(T.o)();case 8:n=e.sent,(r=n.roles)&&r.length>0&&r.forEach((function(e){"counsellor"===e.type&&ce(e)})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))(),function(){w.ValidatorForm.removeValidationRule("MAX_CODE_LENGTH"),w.ValidatorForm.removeValidationRule("VALID_INPUT"),w.ValidatorForm.removeValidationRule("MAX_PHONE_LENGTH"),w.ValidatorForm.removeValidationRule("MAX_POSTAL_CODE")}}),[]);var ge=function(e){return new Promise((function(t){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t(e.target.result)},a.onerror=function(e){console.log("Error: ",e)}}))},Oe=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files[0],!["image/jpeg","image/jpg","image/png","image/svg","image/svg+xml"].includes(a.type)){e.next=9;break}return e.next=5,ge(a);case 5:a.base64=e.sent,O(Object(r.a)(Object(r.a)({},s),{},{logo:a})),e.next=11;break;case 9:J("Only files with following extensions are allowed: jpeg, jpg, png, svg"),H(!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=Object(i.a)(l.a.mark((function e(t){var a,n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("files",t),n="",localStorage.accessToken&&(n=localStorage.accessToken),e.next=6,fetch("http://localhost:1337/api/upload",{method:"post",headers:{authorization:"Bearer "+n},body:a});case 6:return r=e.sent,e.next=9,r.text();case 9:return i=e.sent,e.abrupt("return",JSON.parse(i));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(i.a)(l.a.mark((function e(a){var n,r,i,o,c,d,u,m,b,j,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.firstName,i=s.lastName,o=s.email,c=s.area_code,d=s.phone_number,u=s.traumas,m=s.logo,ne(!0),!m){e.next=6;break}return e.next=5,ve(m);case 5:b=e.sent;case 6:j=u.map((function(e){return Z.find((function(t){if(t&&t.attributes&&t.attributes.trauma_code===e)return t.id}))})),p={counsellor:{data:{name:r+" "+i,first_name:r,last_name:i,email:o,area_code:c,phone_number:d,centers:null===t||void 0===t||null===(n=t.center)||void 0===n?void 0:n.id,status:"Pending",traumas:j,publishedAt:N()().format().split("T")[0]+" "+N()().format().split("T")[1].slice(0,8)}},traumas:j,user:{data:{email:o,confirmed:!0,blocked:!1,role:oe.id}}},m&&(p.counsellor.data.logo_image=b[0].url||""),Object(T.c)(p).then((function(e){var t;"UnauthorizedError"===(null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.name)&&(ue(!0),pe("Your session has expired. You will be logged out.")),e&&"success"===e.status?(J("Provider created successfully"),z(!0)):e&&"fail"===e.status?(ne(!1),J(e.message),H(!0)):(ne(!1),J("Something went wrong"),H(!0))})).catch((function(e){ne(!1),J("Something went wrong"),H(!0)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=s.firstName,we=s.lastName,Ce=s.email,Ne=s.area_code,Te=s.phone_number,ke=s.traumas,Se=s.logo;return Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(u.a,{container:!0,className:"clinician-container",children:[Object(I.jsx)(u.a,{className:"client-breadcrumb",children:Object(I.jsx)(V.b,{routeSegments:[{name:"Add Provider"}]})}),Object(I.jsxs)("div",{className:"center-card",children:[Object(I.jsxs)(w.ValidatorForm,{ref:he,onSubmit:_e,onError:function(){return null},children:[Object(I.jsxs)(u.a,{container:!0,rowSpacing:2,columnSpacing:6,children:[Object(I.jsx)(u.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(I.jsx)(F,{autoFocus:!0,margin:"dense",id:"first_name",name:"firstName",label:"First Name*",type:"text",value:ye,onChange:xe,fullWidth:!0,validators:["required"],errorMessages:["This field is required"]})}),Object(I.jsx)(u.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(I.jsx)(F,{margin:"dense",id:"last_name",name:"lastName",label:"Last Name*",type:"text",value:we,onChange:xe,fullWidth:!0,validators:["required"],errorMessages:["This field is required"]})})]}),Object(I.jsxs)(u.a,{container:!0,rowSpacing:2,columnSpacing:6,children:[Object(I.jsx)(u.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(I.jsx)(F,{margin:"dense",id:"email",name:"email",label:"Email*",type:"email",value:Ce,onChange:xe,fullWidth:!0,validators:["required","isEmail"],errorMessages:["This field is required","email is not valid"]})}),Object(I.jsxs)(u.a,{item:!0,lg:6,md:6,sm:12,xs:12,style:{display:"flex"},className:"add-phone",children:[Object(I.jsx)(u.a,{item:!0,xs:3,sm:3,md:3,lg:3,children:Object(I.jsx)(F,{margin:"dense",id:"area_code",name:"area_code",label:"Area Code*",type:"text",value:Ne,onChange:xe,fullWidth:!0,validators:["required","VALID_INPUT","MAX_CODE_LENGTH"],errorMessages:["This field is required","Invalid area code","Area code should have 3 digits"]})}),Object(I.jsx)(u.a,{item:!0,xs:1,sm:1,md:1,lg:1,children:Object(I.jsx)("div",{className:"phone_line",children:"\xa0"})}),Object(I.jsx)(u.a,{item:!0,xs:8,sm:8,md:8,lg:8,children:Object(I.jsx)(F,{margin:"dense",id:"phone_number",name:"phone_number",label:"Phone Number*",type:"text",value:Te,onChange:xe,fullWidth:!0,validators:["required","VALID_INPUT","MAX_PHONE_LENGTH"],errorMessages:["This field is required","Invalid phone number","Phone number must be of 7 digits"]})})]})]}),Object(I.jsx)(u.a,{container:!0,rowSpacing:2,columnSpacing:6,children:Object(I.jsx)(u.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(I.jsx)(v.a,{sx:{minWidth:120},children:Object(I.jsxs)(m.a,{sx:{mt:2,width:"100%"},children:[Object(I.jsx)(b.a,{id:"open-select-label",children:"Trauma Type"}),Object(I.jsxs)(j.a,{labelId:"open-select-label",margin:"dense",id:"center_type",name:"traumas",multiple:!0,value:ke,input:Object(I.jsx)(p.a,{label:"Trauma Type"}),onChange:function(e){return O(Object(r.a)(Object(r.a)({},s),{},{traumas:e.target.value}))},fullWidth:!0,validators:["required"],children:[Object(I.jsx)(h.a,{disabled:!0,value:"",children:Object(I.jsx)("em",{children:"Trauma Type"})}),Z&&Z.map((function(e,t){return Object(I.jsx)(h.a,{value:e.attributes.trauma_code,children:e.attributes.trauma_name},t)}))]})]})})})}),Object(I.jsxs)(u.a,{item:!0,lg:12,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"20px"},children:[Se?Object(I.jsx)(P,{src:Se.base64}):Object(I.jsxs)(M,{variant:"contained",component:"label",children:[Object(I.jsx)(f.a,{children:"file_upload_outlined"}),"Upload Logo",Object(I.jsx)("input",{type:"file",hidden:!0,accept:"image/*",multiple:!0,onChange:Oe})]}),Object(I.jsx)(u.a,{item:!0,style:{flexDirection:"column"},children:Object(I.jsx)(d.a,{variant:"contained",component:"label",color:"inherit",sx:{marginLeft:"15px",marginTop:"15px",height:"35px",marginBottom:"16px"},onClick:function(){return O(Object(r.a)(Object(r.a)({},s),{},{logo:null,logo_image:""}))},children:"Reset Logo"})})]}),Object(I.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:Object(I.jsx)(L,{flexWrap:"wrap",children:Object(I.jsxs)(v.a,{mr:2,position:"relative",mt:4,children:[Object(I.jsx)(k.a,{size:"medium",loading:ae,variant:"contained",type:"submit",children:"Submit"}),Object(I.jsx)(d.a,{sx:{ml:2},variant:"contained",color:"error",onClick:function(){return he.current.resetValidations(),O(Object(r.a)(Object(r.a)({},s),{},{firstName:"",lastName:"",email:"",area_code:Ne,phone_number:"",traumas:[],logo:null,logo_image:""})),void e(-1)},children:"Cancel"})]})})})]}),Object(I.jsx)(x.a,{open:q,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2e3,onClose:function(){H(!1)},children:Object(I.jsx)(g.a,{onClose:function(){H(!1)},variant:"filled",severity:"error",sx:{width:"100%"},children:B})}),Object(I.jsx)(x.a,{open:X,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2e3,onClose:function(){H(!1),e("/clinicians")},children:Object(I.jsx)(g.a,{onClose:function(){H(!1),e("/clinicians")},variant:"filled",severity:"success",sx:{width:"100%"},children:B})}),Object(I.jsx)(D.a,{open:de,text:je,onConfirmDialogClose:function(){pe(""),ue(!1)},onYesClick:function(){pe(""),ue(!1)}})]})]})})}}}]);
//# sourceMappingURL=56.6b993706.chunk.js.map